# –°—Ç–∞—Ç—É—Å —Ñ–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ three_pow_two_pow_sub_one_valuation

**–î–∞—Ç–∞:** 2 –æ–∫—Ç—è–±—Ä—è 2025  
**–í—Ä–µ–º—è:** 10:15 UTC

---

## ‚úÖ –î–æ—Å—Ç–∏–≥–Ω—É—Ç–æ

1. **Helper –ª–µ–º–º—ã —Å–æ–∑–¥–∞–Ω—ã** –≤ `Collatz/Arithmetic.lean`:
   - `int_modEq_iff_zmod_eq` ‚Äî —ç–∫–≤–∏–≤–∞–ª–µ–Ω—Ç–Ω–æ—Å—Ç—å –º–µ–∂–¥—É Int.ModEq –∏ ZMod
   - `int_modEq_to_zmod` ‚Äî –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è Int.ModEq ‚Üí ZMod  
   - `zmod_to_int_modEq` ‚Äî –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è ZMod ‚Üí Int.ModEq
   - `natCast_pow_zmod_eq_one` ‚Äî –∫–æ–º–º—É—Ç–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–∞—Å—Ç–∞ –¥–ª—è —Å—Ç–µ–ø–µ–Ω–µ–π
   - `natCast_pow_eq_intCast_pow` ‚Äî —Ä–∞–≤–µ–Ω—Å—Ç–≤–æ —Å—Ç–µ–ø–µ–Ω–µ–π

2. **–ë–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π —Ä–∞–±–æ—Ç–∞–µ—Ç** (`k=1`):
   ```lean
   ¬∑ -- k = 0 ‚Üí k+1 = 1
     subst hk_prev
     constructor
     ¬∑ norm_num  -- ‚úÖ 3^2 ‚â° 1 (mod 8)
     ¬∑ intro h; norm_num at this  -- ‚úÖ ¬¨(3^2 ‚â° 1 (mod 16))
   ```

---

## ‚ö†Ô∏è –¢–µ–∫—É—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ç–∏–ø–æ–≤

**–û—à–∏–±–∫–∞:**
```
Tactic `rewrite` failed: Did not find an occurrence of the pattern
  @Eq (ZMod ?m.238) (‚Üë?m.237 ^ ?m.239) 1
in the target expression
  @Eq (ZMod (2 ^ (k + 2))) (3 ^ 2 ^ k) 1
```

**–ü—Ä–∏—á–∏–Ω–∞:** –¢–∏–ø `(3 : ZMod ...)^k` –Ω–µ —É–Ω–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç—Å—è —Å `(‚Üëa : ZMod ...)^k`

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ú–æ–¥—É–ª—å –Ω–µ —Å–æ–≤–ø–∞–¥–∞–µ—Ç

**–û—à–∏–±–∫–∞:**
```
could not unify ...
  ‚Üë?m.309 ‚â° ‚Üë?m.310 [ZMOD ‚Üë(2 ^ (k + 3))]
with the goal
  3 ^ (2 * 2 ^ k) ‚â° 1 [ZMOD 2 ^ (k + 1 + 2)]
```

**–ü—Ä–∏—á–∏–Ω–∞:** `k + 3 ‚â† k + 1 + 2` (—Ö–æ—Ç—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ —ç—Ç–æ –æ–¥–Ω–æ –∏ —Ç–æ –∂–µ)

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç: –£–ø—Ä–æ—Å—Ç–∏—Ç—å —Å–∏–≥–Ω–∞—Ç—É—Ä—É –ª–µ–º–º—ã

–ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å `three_pow_two_pow_sub_one_valuation` –∏—Å–ø–æ–ª—å–∑—É—è `ZMod` –Ω–∞–ø—Ä—è–º—É—é –≤–º–µ—Å—Ç–æ `Int.ModEq`:

```lean
-- –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è –ª–µ–º–º–∞ —Å ZMod
lemma three_pow_two_pow_sub_one_valuation_zmod (k : ‚Ñï) (hk : k ‚â• 1) :
  (3 : ZMod (2^(k+2)))^(2^k) = 1 ‚àß 
  (3 : ZMod (2^(k+3)))^(2^k) ‚â† 1 := by
  -- –ü—Ä—è–º–∞—è –∏–Ω–¥—É–∫—Ü–∏—è –±–µ–∑ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤
  induction k with
  | zero => omega
  | succ k ih =>
    by_cases hk_prev : k = 0
    ¬∑ -- Base case: k+1 = 1
      subst hk_prev
      constructor
      ¬∑ decide  -- 3^2 = 9 = 1 (mod 8)
      ¬∑ decide  -- 3^2 = 9 ‚â† 1 (mod 16)
    ¬∑ -- Inductive step
      have hk_ge : k ‚â• 1 := by omega
      have ‚ü®ih_lower, ih_upper‚ü© := ih hk_ge
      -- –ò—Å–ø–æ–ª—å–∑—É–µ–º pow_lift_double –Ω–∞–ø—Ä—è–º—É—é
      constructor
      ¬∑ exact Arithmetic.pow_lift_double Arithmetic.three_odd (by omega) ih_lower
      ¬∑ intro h_contra
        -- –ü—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ...
        sorry

-- –û—Å–Ω–æ–≤–Ω–∞—è –ª–µ–º–º–∞ ‚Äî –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∏–∑ ZMod –∫ Int.ModEq
lemma three_pow_two_pow_sub_one_valuation (k : ‚Ñï) (hk : k ‚â• 1) :
  (3 : ‚Ñ§)^(2^k) ‚â° 1 [ZMOD 2^(k+2)] ‚àß 
  ¬¨((3 : ‚Ñ§)^(2^k) ‚â° 1 [ZMOD 2^(k+3)]) := by
  have ‚ü®h1, h2‚ü© := three_pow_two_pow_sub_one_valuation_zmod k hk
  constructor
  ¬∑ apply Collatz.Arithmetic.zmod_to_int_modEq (pow_pos (by norm_num) (k+2))
    convert h1 using 1
    norm_cast
  ¬∑ intro h_contra
    apply h2
    apply Collatz.Arithmetic.int_modEq_to_zmod (pow_pos (by norm_num) (k+3))
    convert h_contra using 1
    norm_cast; norm_cast
```

---

## ‚è±Ô∏è –û—Ü–µ–Ω–∫–∞

- –°–æ–∑–¥–∞–Ω–∏–µ `three_pow_two_pow_sub_one_valuation_zmod`: 1-2—á
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∫ Int.ModEq: 0.5—á
- –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –≤–µ—Ä—Ö–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã: 1-1.5—á
- **–ò—Ç–æ–≥–æ:** 2.5-4 —á–∞—Å–∞

---

## üìä –ü—Ä–æ–≥—Ä–µ—Å—Å —Å–µ—Å—Å–∏–∏

| –ó–∞–¥–∞—á–∞ | –°—Ç–∞—Ç—É—Å |
|--------|--------|
| Helper –ª–µ–º–º—ã | ‚úÖ –°–æ–∑–¥–∞–Ω—ã |
| –ë–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| –ò–Ω–¥—É–∫—Ç–∏–≤–Ω—ã–π —à–∞–≥ (–Ω–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞) | ‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º—ã —Å —Ç–∏–ø–∞–º–∏ |
| –ò–Ω–¥—É–∫—Ç–∏–≤–Ω—ã–π —à–∞–≥ (–≤–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞) | ‚ùå –ù–µ –Ω–∞—á–∞—Ç–æ |
| –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –∫ Int.ModEq | ‚ùå –ù–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ |

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –°–æ–∑–¥–∞—Ç—å `three_pow_two_pow_sub_one_valuation_zmod` –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë –¥–ª—è –æ—Å–Ω–æ–≤–Ω–æ–π –ª–µ–º–º—ã.

