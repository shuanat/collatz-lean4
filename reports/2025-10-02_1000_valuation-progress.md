# –ü—Ä–æ–≥—Ä–µ—Å—Å —Ñ–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ three_pow_two_pow_sub_one_valuation

**–î–∞—Ç–∞:** 2 –æ–∫—Ç—è–±—Ä—è 2025  
**–í—Ä–µ–º—è:** 10:00 UTC

---

## üéØ –¶–µ–ª—å

–§–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–µ–º–º—É `three_pow_two_pow_sub_one_valuation`:

```lean
lemma three_pow_two_pow_sub_one_valuation (k : ‚Ñï) (hk : k ‚â• 1) :
  (3 : ‚Ñ§)^(2^k) ‚â° 1 [ZMOD 2^(k+2)] ‚àß 
  ¬¨((3 : ‚Ñ§)^(2^k) ‚â° 1 [ZMOD 2^(k+3)])
```

---

## ‚ö†Ô∏è –û—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞

**–ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ —Ç–∏–ø–æ–≤:**
- –õ–µ–º–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `Int.ModEq` (—Ä–∞–±–æ—Ç–∞–µ—Ç —Å `‚Ñ§`)
- `pow_lift_double` —Ä–∞–±–æ—Ç–∞–µ—Ç —Å `ZMod (2^t)` (–ø—Ä–∏–Ω–∏–º–∞–µ—Ç `‚Ñï`)
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –º–µ–∂–¥—É `Int.ModEq` –∏ `ZMod` –æ–∫–∞–∑–∞–ª–∞—Å—å —Å–ª–æ–∂–Ω–æ–π

### –ü–æ–ø—ã—Ç–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏:

1. **`Int.coe_nat_mod`** ‚Äî –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ mathlib4
2. **`ZMod.intCast_eq_intCast_iff`** ‚Äî —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Å–æ–∑–¥–∞—ë—Ç –ø—Ä–æ–±–ª–µ–º—ã —Å —Ç–∏–ø–∞–º–∏:
   ```lean
   show ((3 : ‚Ñ§) : ZMod (2^(k+2)))^(2^k) = 1
   -- vs
   show (3 : ZMod (2^(k+2)))^(2^k) = 1  -- –æ–∂–∏–¥–∞–µ—Ç—Å—è –¥–ª—è pow_lift_double
   ```

3. **`push_cast` + `rfl`** ‚Äî –Ω–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç —Ü–µ–ª—å –∏–∑-–∑–∞ definitional –Ω–µ—Ä–∞–≤–µ–Ω—Å—Ç–≤–∞

---

## üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç A: –ü–µ—Ä–µ—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –ª–µ–º–º—É –¥–ª—è –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã—Ö —á–∏—Å–µ–ª

–í–º–µ—Å—Ç–æ `Int.ModEq` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Nat.ModEq` –∏–ª–∏ –ø—Ä—è–º–æ `ZMod`:

```lean
lemma three_pow_two_pow_sub_one_valuation_nat (k : ‚Ñï) (hk : k ‚â• 1) :
  (3 : ZMod (2^(k+2)))^(2^k) = 1 ‚àß 
  ¬¨((3 : ZMod (2^(k+3)))^(2^k) = 1) := by
  -- –ü—Ä—è–º–∞—è –∏–Ω–¥—É–∫—Ü–∏—è —Å pow_lift_double
  sorry
```

–ó–∞—Ç–µ–º –¥–æ–∫–∞–∑–∞—Ç—å –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—É—é –ª–µ–º–º—É –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –∫ `Int.ModEq`.

### –í–∞—Ä–∏–∞–Ω—Ç B: –°–æ–∑–¥–∞—Ç—å helper –ª–µ–º–º—ã –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏

```lean
lemma int_modEq_to_zmod {a b n : ‚Ñï} (h : (a : ‚Ñ§) ‚â° (b : ‚Ñ§) [ZMOD (n : ‚Ñ§)]) :
  (a : ZMod n) = (b : ZMod n) := by
  sorry

lemma zmod_to_int_modEq {a b n : ‚Ñï} (h : (a : ZMod n) = (b : ZMod n)) :
  (a : ‚Ñ§) ‚â° (b : ‚Ñ§) [ZMOD (n : ‚Ñ§)] := by
  sorry
```

### –í–∞—Ä–∏–∞–Ω—Ç C: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å LTE –Ω–∞–ø—Ä—è–º—É—é

–°–æ–≥–ª–∞—Å–Ω–æ —ç–∫—Å–ø–µ—Ä—Ç–Ω—ã–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `padicValNat_pow_sub_pow_of_even`:

```lean
import Mathlib.NumberTheory.Padics.PadicVal

lemma three_pow_two_pow_sub_one_valuation (k : ‚Ñï) (hk : k ‚â• 1) :
  ... := by
  -- –ü—Ä–∏–º–µ–Ω—è–µ–º LTE lemma
  have h_lte := padicValNat_pow_sub_pow_of_even 2 3 1 (2^k) ...
  -- –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º valuation –∫ –¥–µ–ª–∏–º–æ—Å—Ç–∏
  sorry
```

---

## üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å

### –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

‚úÖ **–ë–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π `k=1`:**
```lean
| succ k ih =>
  by_cases hk_prev : k = 0
  ¬∑ -- k = 0 ‚Üí k+1 = 1
    subst hk_prev
    constructor
    ¬∑ -- 3^2 ‚â° 1 (mod 8): —Ä–∞–±–æ—Ç–∞–µ—Ç norm_num
      norm_num
    ¬∑ -- ¬¨(3^2 ‚â° 1 (mod 16)): —Ä–∞–±–æ—Ç–∞–µ—Ç norm_num
      intro h
      norm_num at this
```

### –ß—Ç–æ –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç:

‚ùå **–ò–Ω–¥—É–∫—Ç–∏–≤–Ω—ã–π —à–∞–≥ ‚Äî –Ω–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞:**
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è `Int.ModEq` ‚Üí `ZMod` –¥–ª—è `pow_lift_double`
- –û—à–∏–±–∫–∞: `show ((3 : ‚Ñ§) : ZMod ...)^k = 1` –Ω–µ —Ä–∞–≤–Ω–æ `show (3 : ZMod ...)^k = 1`

‚ùå **–ò–Ω–¥—É–∫—Ç–∏–≤–Ω—ã–π —à–∞–≥ ‚Äî –≤–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞:**
- –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—è –∏–∑ `3^{2k} ‚â° 1 (mod 2^{k+4})`
- –ü—Ä–æ–±–ª–µ–º–∞: –Ω—É–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ —ç—Ç–æ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏—Ç IH

---

## üîß –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –®–∞–≥ 1: –°–æ–∑–¥–∞—Ç—å helper –ª–µ–º–º—ã –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤

```lean
-- –í Arithmetic.lean –∏–ª–∏ OrdFact.lean
namespace Helper

lemma natCast_pow_zmod_eq_one {a n k : ‚Ñï} :
  ((a : ‚Ñ§) : ZMod n)^k = 1 ‚Üî (a : ZMod n)^k = 1 := by
  constructor
  ¬∑ intro h
    have : ((a : ‚Ñ§) : ZMod n)^k = ((a : ‚Ñï) : ZMod n)^k := by
      congr 1
      simp
    rw [this] at h
    exact h
  ¬∑ intro h
    have : ((a : ‚Ñï) : ZMod n)^k = ((a : ‚Ñ§) : ZMod n)^k := by
      congr 1
      simp
    rw [‚Üê this]
    exact h

lemma int_modEq_iff_zmod {a b n : ‚Ñï} :
  (a : ‚Ñ§) ‚â° (b : ‚Ñ§) [ZMOD (n : ‚Ñ§)] ‚Üî (a : ZMod n) = (b : ZMod n) := by
  sorry  -- –ù—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ mathlib4 –∏–ª–∏ –¥–æ–∫–∞–∑–∞—Ç—å

end Helper
```

### –®–∞–≥ 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å helper –ª–µ–º–º—ã –≤ –¥–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–µ

```lean
have h_zmod : (3 : ZMod (2^(k+2)))^(2^k) = 1 := by
  rw [‚Üê Helper.natCast_pow_zmod_eq_one]
  rw [‚Üê Helper.int_modEq_iff_zmod]
  exact ih_lower
```

### –®–∞–≥ 3: –î–æ–∫–∞–∑–∞—Ç—å –≤–µ—Ä—Ö–Ω—é—é –≥—Ä–∞–Ω–∏—Ü—É —á–µ—Ä–µ–∑ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ

–ö–ª—é—á–µ–≤–∞—è –∏–¥–µ—è: –µ—Å–ª–∏ `x^2 = 1` –≤ `ZMod (2^m)` –¥–ª—è `m ‚â• 2`, —Ç–æ `x ‚àà {1, 2^m - 1}`.

---

## üìÅ –§–∞–π–ª—ã –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è

1. **`Collatz/Arithmetic.lean`** ‚Äî –¥–æ–±–∞–≤–∏—Ç—å helper –ª–µ–º–º—ã
2. **`Collatz/OrdFact.lean`** ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å helper –ª–µ–º–º—ã

---

## ‚è±Ô∏è –û—Ü–µ–Ω–∫–∞ –≤—Ä–µ–º–µ–Ω–∏

- –°–æ–∑–¥–∞–Ω–∏–µ helper –ª–µ–º–º: 0.5-1—á
- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –Ω–∏–∂–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã: 0.5—á
- –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –≤–µ—Ä—Ö–Ω–µ–π –≥—Ä–∞–Ω–∏—Ü—ã: 1-1.5—á
- **–ò—Ç–æ–≥–æ:** 2-3 —á–∞—Å–∞

---

## üö® –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å —Å–∏–≥–Ω–∞—Ç—É—Ä—É

–ï—Å–ª–∏ helper –ª–µ–º–º—ã –æ–∫–∞–∂—É—Ç—Å—è —Å–ª–∏—à–∫–æ–º —Å–ª–æ–∂–Ω—ã–º–∏, –º–æ–∂–Ω–æ:

1. –ò–∑–º–µ–Ω–∏—Ç—å —Å–∏–≥–Ω–∞—Ç—É—Ä—É –Ω–∞ `Nat.ModEq` –∏–ª–∏ –ø—Ä—è–º–æ `ZMod`
2. –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`three_pow_Qt_eq_one`, `ord_three_mod_pow_two`)
3. –≠—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π, –Ω–æ –ø—Ä–æ—â–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏

---

## üí≠ –í—ã–≤–æ–¥

–û—Å–Ω–æ–≤–Ω–∞—è —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å–ª–æ–∂–Ω–æ—Å—Ç—å ‚Äî –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –º–µ–∂–¥—É `Int.ModEq` –∏ `ZMod` –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å `pow_lift_double`.

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –°–æ–∑–¥–∞—Ç—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å helper –ª–µ–º–º—ã –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ —Ç–∏–ø–æ–≤.

